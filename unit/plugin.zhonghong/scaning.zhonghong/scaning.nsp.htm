<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="basepath" content="/doc">
<meta name="provider" content="北京中宏立达科技发展有限公司">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/style_003.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/style_005.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/style_004.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/style.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/style_002.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/custom-animate.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/custom-base.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/comm_003.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/paper.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/scan.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/gridBlank.css" type="text/css" media="all">
<link rel="stylesheet" rev="stylesheet" href="scaning.nsp_files/comm_002.css" type="text/css" media="all">
<script type="text/javascript" src="scaning.nsp_files/Netiler.js"></script>
<script type="text/javascript" src="scaning.nsp_files/JTemplate.js"></script>
<script type="text/javascript" src="scaning.nsp_files/NetilerUI_002.js"></script>
<script type="text/javascript" src="scaning.nsp_files/NetilerUI.js"></script>
<script type="text/javascript" src="scaning.nsp_files/custom-kmsUI_DEBUG.js"></script>
<script type="text/javascript" src="scaning.nsp_files/custom-predator_DEBUG.js"></script>
<script type="text/javascript" src="scaning.nsp_files/custom-nExtend_DEBUG.js"></script>
<script type="text/javascript" src="scaning.nsp_files/custom-theme_DEBUG.js"></script><link id="netileruiFontSizeLink" href="scaning.nsp_files/fontSize.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="scaning.nsp_files/custom-offline_DEBUG.js"></script>
<script type="text/javascript" src="scaning.nsp_files/custom-animate_DEBUG.js"></script>
<script type="text/javascript" src="scaning.nsp_files/custom-nbCompatible_DEBUG.js"></script>
<script type="text/javascript" src="scaning.nsp_files/com.js"></script>
<script type="text/javascript" src="scaning.nsp_files/com_002.js"></script>
<link rel="stylesheet" type="text/css" href="scaning.nsp_files/loading.css"><link rel="stylesheet" type="text/css" href="scaning.nsp_files/layout.css"><link rel="stylesheet" type="text/css" href="scaning.nsp_files/winpanel.css"><link rel="stylesheet" type="text/css" href="scaning.nsp_files/comm.css"><link rel="stylesheet" type="text/css" href="scaning.nsp_files/toolbar.css"><link rel="stylesheet" type="text/css" href="scaning.nsp_files/blocks.css"></head>
<body basepath="/doc" style="">
<style>
	body{
		overflow:hidden;
	}
	.settingTable{
		margin : 0px auto;
	}
	.settingTable td{
		text-align : left;
		font-weight: bold;
	}
</style>
<script>
	function autoLoadEmbed(){
	    var win = window.parent;
		var obj=win.document.getElementById('top_scanner');
		if(obj){
			return;
		}
	    var embed =win.document.createElement("embed");
		embed.setAttribute('id','top_scanner');
		embed.setAttribute('type','application/top-scanner-plugin');
		embed.setAttribute('thumbnailPX','200');
		embed.setAttribute('style','width:1px;height:1px');
		win.document.body.appendChild(embed);
	}
	autoLoadEmbed();
</script><embed id="top_scanner" type="application/top-scanner-plugin" thumbnailpx="200" style="width:1px;height:1px"><embed id="leadal_util" type="application/leadal-util-plugin" height="40" width="200">
    <div style="width:100%;height:100%;position:relative;" id="paperscanningId">
        <layout:winpanel closebtn="true" id="nui_1594210604368" _rendered="true"><div class="ld-top-layout-winpanel"><div class="ld-top-layout-winpanel-head">    <div class="ld-top-layout-winpanel-centerbar"></div>    <div class="ld-top-layout-winpanel-rightbar js_winpanel_right" bodytag="*">                <span style="float:right;margin:5px 5px 0">        <btn:close onclick="window.close();" _dorendered="true" id="nui_1594210604382" _rendered="true"><ui:button type="close-btn" _dorendered="true" id="nui_1594210604384" parentuid="nui_1594210604382" _rendered="true"><div class="ld-top-btn-layout close-btn  js_button_container"><div class="ld-top-btn close-btn "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:close>        </span>            <winpanel:rightbar>
        	</winpanel:rightbar></div>    <div class="ld-top-layout-winpanel-leftbar js_winpanel_left" bodytag="*">    <winpanel:leftbar>
        		<p style="margin-left:20px;font-weight:bold;">纸质文件扫描</p> 
        	</winpanel:leftbar></div></div>    <div class="ld-top-layout-winpanel-body js_winpanel_body" bodytag="*"><winpanel:body>
                <div class="paper-scanning">
                	<div class="paper-scanning-box">
                		<i class="paper-scanning-icon"></i>
						
						<table class="settingTable" border="0">
							<tbody><tr>
								<td>
									<label style="margin-right:20px;">设备选择</label>
									<label>
								</label></td>
								<td>
									<select name="devicesName" id="devicesName" onchange="ScanUtil.getDeviceSolution()"><option value="0" selected="selected">Uniscan Q223X-II</option><option value="1">科图高速扫描仪-TWAIN</option></select>
								</td>
							</tr>
							<tr name="linuxparams" style="display:none;">
								<td>
									<label style="margin-right:20px;">色彩</label>
								</td>
								<td>
									<select id="pixeltype">                                        
                                    </select>
								</td>
							</tr>
							
							<tr name="linuxparams" style="display:none;">
								<td>
									<label style="margin-right:20px;">分辨率</label>
								</td>
								<td>
									<select id="resolution">										
                                    </select>
								</td>
							</tr>
							
							<tr name="linuxparams" style="display:none;">
								<td>
									<label style="margin-right:20px;">单双面</label>
								</td>
								<td>
									<select id="paperSingle">
                    					<option value="0" selected="selected">单面</option>
                                        <option value="1">双面</option>
                                    </select>
								</td>
							</tr>
                        </tbody></table>
                        
                        <p style="font-size:16px;font-weight:bold;margin-top:30px;">请将需要扫描的文件放入扫描仪中</p>
                		<p style="color:red;font-size:14px;margin-top:10px;">(提示：每次只扫描一次文件)</p>
                		<span class="paper-scanning-btn" onclick="ScanUtil.start();">
            				<btn:blue-big id="btn_doScan" ipad="20" caption="开始扫描" _dorendered="true" _rendered="true"><ui:button caption="开始扫描" type="bgc-mode-blue-big" ipad="20" _dorendered="true" id="nui_1594210604383" parentuid="btn_doScan" _rendered="true"><div class="ld-top-btn-layout bgc-mode-blue-big  js_button_container"><div class="ld-top-btn bgc-mode-blue-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:20px;padding-right:20px;">                        <span class="ld-top-btn-title js_buttonCaption">开始扫描</span>        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:blue-big>
            			</span>
                	</div>
                </div>
        	</winpanel:body></div></div></layout:winpanel>
    </div>
    
    <div style="width:100%;height:100%;position:relative;display:none" class="ld-top-paperbodyId" id="paperbodyId">
        <layout:winpanel closebtn="true" id="nui_1594210604369" _rendered="true"><div class="ld-top-layout-winpanel"><div class="ld-top-layout-winpanel-head">    <div class="ld-top-layout-winpanel-centerbar"></div>    <div class="ld-top-layout-winpanel-rightbar js_winpanel_right" bodytag="*">                <span style="float:right;margin:5px 5px 0">        <btn:close onclick="window.close();" _dorendered="true" id="nui_1594210604385" _rendered="true"><ui:button type="close-btn" _dorendered="true" id="nui_1594210604398" parentuid="nui_1594210604385" _rendered="true"><div class="ld-top-btn-layout close-btn  js_button_container"><div class="ld-top-btn close-btn "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:close>        </span>            <winpanel:rightbar>
        		<btn:btn-big caption="保存" icon="icon_save" onclick="scanBlock.save('receival','f0f691bd3e244f45a1e731788e304d1f',null,null,'true','')" id="nui_1594210604370" _dorendered="true" _rendered="true"><ui:button caption="保存" icon="icon_save" type="normal-big" _dorendered="true" id="nui_1594210604397" parentuid="nui_1594210604370" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_save js_btn_icon"></i>                        <span class="ld-top-btn-title js_buttonCaption">保存</span>        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
        		<btn:btn-big caption="追加纸张" icon="icon_add" onclick="ScanUtil.addPaper();" id="nui_1594210604371" _dorendered="true" _rendered="true"><ui:button caption="追加纸张" icon="icon_add" type="normal-big" _dorendered="true" id="nui_1594210604396" parentuid="nui_1594210604371" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_add js_btn_icon"></i>                        <span class="ld-top-btn-title js_buttonCaption">追加纸张</span>        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
				<btn:btn-big caption="扫描下一个" icon="icon_refresh" onclick="ScanUtil.scanNext('receival','f0f691bd3e244f45a1e731788e304d1f','true','');" id="nui_1594210604372" _dorendered="true" _rendered="true"><ui:button caption="扫描下一个" icon="icon_refresh" type="normal-big" _dorendered="true" id="nui_1594210604395" parentuid="nui_1594210604372" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_refresh js_btn_icon"></i>                        <span class="ld-top-btn-title js_buttonCaption">扫描下一个</span>        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
				<btn:btn-big caption="切换扫描仪" icon="icon_scanner" onclick="ScanUtil.changeScanner();" id="nui_1594210604373" _dorendered="true" _rendered="true"><ui:button caption="切换扫描仪" icon="icon_scanner" type="normal-big" _dorendered="true" id="nui_1594210604394" parentuid="nui_1594210604373" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_scanner js_btn_icon"></i>                        <span class="ld-top-btn-title js_buttonCaption">切换扫描仪</span>        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
        	</winpanel:rightbar></div>    <div class="ld-top-layout-winpanel-leftbar js_winpanel_left" bodytag="*">    <winpanel:leftbar>
        		<p style="margin-left:20px;font-weight:bold;">纸质文件扫描</p> 
        	</winpanel:leftbar></div></div>    <div class="ld-top-layout-winpanel-body js_winpanel_body" bodytag="*"><winpanel:body>
                <div class="paper-scan-page">
                	<div class="paper-scan-page-inner">
                        <div class="paper-scan-page-left">
                			<div class="paper-scan-page-left-inner" style="overflow:auto">
                				<div style="clear:both">
                                </div>
        						<ui:blocks id="scanblockId" events="scanBlock.events" clickauto="true" class="js_scan_blocks" render="scanBlock.render" style="height:100%" _dorendered="true" _rendered="true"><div class="ld-blocks-layout"><ul id="blocksBody_scanblockId" class="ld-blocks-body js_blocks_body" style="height: 100%;"></ul></div></ui:blocks>
        						<div style="clear:both">
                                </div>
                			</div>
                		</div>
                		<div class="paper-scan-page-right">
                			<div class="paper-scan-page-source-layout">
                				<div class="paper-scan-page-source">
                					<img id="js_scan_bigImg" class="js_scan_bigImg" style="display:none">
                                </div>
                            </div>
                			<div class="paper-scan-page-toolbar">
                				<div class="paper-scan-page-toolbar-btn">
        							<btn:btn-big icon="icon_pre" onclick="scanBlock.pre()" id="nui_1594210604374" _dorendered="true" _rendered="true"><ui:button icon="icon_pre" type="normal-big" _dorendered="true" id="nui_1594210604393" parentuid="nui_1594210604374" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_pre js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                					<btn:btn-big icon="icon_next" onclick="scanBlock.next()" id="nui_1594210604375" _dorendered="true" _rendered="true"><ui:button icon="icon_next" type="normal-big" _dorendered="true" id="nui_1594210604392" parentuid="nui_1594210604375" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_next js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                                    <btn:btn-big icon="icon_fore" onclick="scanBlock.move2pre()" id="nui_1594210604376" _dorendered="true" _rendered="true"><ui:button icon="icon_fore" type="normal-big" _dorendered="true" id="nui_1594210604391" parentuid="nui_1594210604376" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_fore js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                					<btn:btn-big icon="icon_after" onclick="scanBlock.move2next()" id="nui_1594210604377" _dorendered="true" _rendered="true"><ui:button icon="icon_after" type="normal-big" _dorendered="true" id="nui_1594210604390" parentuid="nui_1594210604377" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_after js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                					<btn:btn-big icon="icon_left-turn" onclick="scanBlock.leftTurn()" id="nui_1594210604378" _dorendered="true" _rendered="true"><ui:button icon="icon_left-turn" type="normal-big" _dorendered="true" id="nui_1594210604389" parentuid="nui_1594210604378" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_left-turn js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                					<btn:btn-big icon="icon_right-turn" onclick="scanBlock.rightTurn()" id="nui_1594210604379" _dorendered="true" _rendered="true"><ui:button icon="icon_right-turn" type="normal-big" _dorendered="true" id="nui_1594210604388" parentuid="nui_1594210604379" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_right-turn js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                					                					<btn:btn-big icon="icon_gabage" onclick="scanBlock.del()" id="nui_1594210604380" _dorendered="true" _rendered="true"><ui:button icon="icon_gabage" type="normal-big" _dorendered="true" id="nui_1594210604387" parentuid="nui_1594210604380" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_gabage js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                					<btn:btn-big icon="icon_btn_clear" onclick="scanBlock.clear()" id="nui_1594210604381" _dorendered="true" _rendered="true"><ui:button icon="icon_btn_clear" type="normal-big" _dorendered="true" id="nui_1594210604386" parentuid="nui_1594210604381" _rendered="true"><div class="ld-top-btn-layout normal-big  js_button_container"><div class="ld-top-btn normal-big "><i class="ld-top-icon ld-top-btn-set-left"></i><div class="ld-top-btn-set-center" style="padding-top:px;padding-bottom:px;color:;background-color:">            <div style="padding-left:px;padding-right:px;">        <i class="ld-top-icon ld-top-btn-icon icon_btn_clear js_btn_icon"></i>                        </div></div><i class="ld-top-icon ld-top-btn-set-right"></i></div></div></ui:button></btn:btn-big>
                                </div>
                				<div class="paper-scan-page-desc rf js_scaning_page_info">
                                    0/0
                                </div>
                            </div>
                		</div>
                    </div>
					<div class="paper-scan-loading-layout js_scan_loading" id="scanloadingId" style="display:none;">
                		<div class="paper-scan-mask"></div>
						<div class="paper-scan-loading">
                			<div class="ld-top-grid-spinner big js_list_loading" style="display:block">
                				<div class="double-bounce1"></div>
                				<div class="double-bounce2"></div>
                    		</div>
                            <p>正在扫描，请稍等...</p>
                        </div>
                    </div>
                </div>
        	</winpanel:body></div></div></layout:winpanel>
    </div>
    <input name="scanDocId" id="scanDocId" value="6551a3c9668149488a867f9784e9e256" type="hidden">
	<input name="finalDocId" id="finalDocId" value="" type="hidden">
	<input name="type" id="type" value="" type="hidden">




<script type="text/javascript" src="scaning.nsp_files/comm.js"></script>
<script type="text/javascript" src="scaning.nsp_files/scanutil.js"></script>
<script type="text/javascript" src="scaning.nsp_files/scan.js"></script>
<script type="text/javascript">//扫描中回调用事件,source 原图路径，thumb 缩略图路径
function scanImage(source,thumb){
	ScanUtil.scanImage(source,thumb);
}
//扫描完毕回调事件
function scanImageComplete(result){
	ScanUtil.scanImageComplete(result);
}
//合并上传回调事件
function mergeImageComplete(result){
	ScanUtil.mergeImageComplete(result);
}
//读取扫描设备回调事件
function listDataSources(devs){
	if(typeof devs == 'undefined' || devs==null || devs.trim()=='null' || devs.trim()==''){
		$loading.hide();
		$window.alert('未能识别到扫描设备，请检查','info');
		return ;
	}
	ScanUtil.findDevices(devs);
	$loading.hide();
}


var scannerObj = window.parent.document.getElementById('top_scanner');
var leadalUtilObj = document.getElementById('leadal_util');
scannerObj.copyImage = scanImage;
scannerObj.copyImageComplete = scanImageComplete;
scannerObj.mergeImageComplete = mergeImageComplete;
scannerObj.listDataSources = listDataSources;
$loading.show('正在识别扫描设备，请稍后...');
NetilerUI.ready(function(){ 
	
    setTimeout(function(){
	
		if(typeof scannerObj.GetListDataSources == 'undefined' || scannerObj.GetListDataSources==null || scannerObj.GetListDataSources=='null' || scannerObj.GetListDataSources==''){
		$loading.hide();
		$window.alert('未能识别到扫描插件，请检查','info');
		return ;
		}
		scannerObj.GetListDataSources();
	},0);
})

	NetilerUI.ready(function(){
		var platform = navigator.platform.toLowerCase();
		if(platform.indexOf("linux") == -1) {
			return;
		}
		
		var paramTrs = document.getElementsByName("linuxparams");
		if(!paramTrs || paramTrs.length<=0){
			return;
		}
		
		for(var i=0;i<paramTrs.length;i++){
			paramTrs[i].style.removeProperty('display');
		}
		
	});

</script>


</body></html>